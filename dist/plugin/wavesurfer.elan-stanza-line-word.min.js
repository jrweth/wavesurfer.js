/*! wavesurfer.js 1.3.2 (Fri, 17 Mar 2017 13:16:44 GMT)
* https://github.com/katspaugh/wavesurfer.js
* @license CC-BY-3.0 */!function(a,b){"function"==typeof define&&define.amd?define(["wavesurfer"],function(a){return b(a)}):"object"==typeof module&&module.exports?module.exports=b(require("wavesurfer.js")):b(a.WaveSurfer)}(this,function(a){"use strict";a.ElanStanzaLineWord=Object.create(a.ELAN),a.util.extend(a.ElanStanzaLineWord,{currentAnnotation:null,currentRow:null,currentRegion:null,currentWord:null,parseElan:function(b){var c=a.ELAN.parseElan(b);return c.stanzas=[],c.lines=[],c.words=[],c.tiers.forEach(function(a){switch(a.id){case"STANZAS":c.stanzas=a.annotations;break;case"LINES":c.lines=a.annotations;break;case"WORDS":c.words=a.annotations}}),c.lines.forEach(function(a,b){c.lines[b].words=[],c.words.forEach(function(d){d.start>=a.start&&d.end<=a.end&&c.lines[b].words.push(d)})}),c.stanzas.forEach(function(a,b){c.stanzas[b].lines=[],c.lines.forEach(function(d){d.start>=a.start&&d.end<=a.end&&c.stanzas[b].lines.push(d)})}),c},render:function(){this.renderedAlignable=this.data.lines;var a=document.createElement("table");a.className="wavesurfer-annotations";var b=document.createElement("thead"),c=document.createElement("tr");b.appendChild(c),a.appendChild(b);var d=document.createElement("th");d.textContent="Time",d.className="wavesurfer-time",c.appendChild(d);var d=document.createElement("th");d.className="wavesurfer-line",d.textContent="Line",c.appendChild(d),this.data.stanzas.forEach(function(b){var c=document.createElement("tbody");c.className="elan-stanza",a.appendChild(c);var d=document.createElement("tr");d.className="elan-wavesurfer-stanza-row";var e=document.createElement("td");e.colSpan=3,d.appendChild(e),c.appendChild(d),b.lines.forEach(function(a){var b=document.createElement("tr");b.id="wavesurfer-alignable-"+a.id,b.dataset.ref=a.id,c.appendChild(b);var d=document.createElement("td");d.className="wavesurfer-time",d.innerHTML=a.start.toFixed(1)+"&mdash;"+a.end.toFixed(1),d.dataset.ref=a.id,b.appendChild(d);var d=document.createElement("td");d.dataset.ref=a.id,d.className="wavesurfer-elan-line",a.words.forEach(function(a){var b=document.createElement("span");b.id="wavesurfer-annotation-"+a.id,b.dataset.start=a.start,b.dataset.end=a.end,b.dataset.ref=a.id,b.textContent=a.value+" ",b.className="wavesurfer-elan-word elan-word-pending",d.appendChild(b)}),b.appendChild(d)},this)},this),this.container.innerHTML="",this.container.appendChild(a)},getStanzaAtTime:function(a){return this.getStructureAtTime("stanzas",a)},getLineAtTime:function(a){return this.getStructureAtTime("lines",a)},getWordAtTime:function(a){return this.getStructureAtTime("words",a)},getStructureAtTime:function(a,b){var c;return this.data[a].some(function(a){return a.start<=b&&a.end>=b&&(c=a,!0)}),c},onProgress:function(a,b){this.updateCurrentLine(a,b),this.updateCurrentWord(a)},updateCurrentLine:function(a,b){var c=this.getRenderedAnnotation(a);if(this.currentAnnotation!=c&&(this.currentAnnotation=c,this.currentRegion&&this.currentRegion.remove(),this.currentRegion=null,c)){var d=this.getAnnotationNode(c);this.currentRow&&this.currentRow.classList.remove("success"),this.currentRow=d,d.classList.add("success"),this.scrollToRow(d),this.currentRegion=b.addRegion({start:c.start,end:c.end,resize:!1,color:"rgba(223, 240, 216, 0.7)"})}},scrollToRow:function(a){var b=window.innerHeight-this.container.getBoundingClientRect().top;(a.offsetTop+a.clientHeight>this.container.scrollTop+b||a.offsetTop<this.container.scrollTop)&&(this.container.scrollTop=a.offsetTop)},updateCurrentWord:function(a){var b=this.getWordAtTime(a);if(this.currentWord!=b){this.currentWord=b;for(var c=document.getElementsByClassName("wavesurfer-elan-word"),d=0;d<c.length;d++){c[d].classList.remove("elan-word-pending"),c[d].classList.remove("elan-word-current"),c[d].classList.remove("elan-word-finished");var e=parseFloat(c[d].getAttribute("data-start"));parseFloat(c[d].getAttribute("data-end"))<a?c[d].classList.add("elan-word-finished"):e>a?c[d].classList.add("elan-word-pending"):c[d].classList.add("elan-word-current")}}}})});